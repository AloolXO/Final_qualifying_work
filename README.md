# Final Qualifying Work

## Описание проекта

Цель данного проекта – разработка программного обеспечения для выделения целевых объектов территории по данным дистанционного зондирования Земли (ДЗЗ). Основные задачи включают классификацию, сегментацию и обнаружение объектов на основе данных ДЗЗ с использованием современных методов машинного и глубокого обучения.

## Функции

- **Предобработка**: Очистка и нормализация спутниковых снимков.
- **Конвертация**: Перевод изображений из одного формата в другой.
- **Кадрирование**: Извлечение заданных областей изображений.
- **Segformer**: Интеграция с архитектурой Segformer для сегментации объектов горной промышленности.

## Требования

- Python 3.11
- Указанные в `requirements.txt` библиотеки

## Установка

### Установка Python и pip

1. Скачайте Python с официального сайта [Python](https://www.python.org/downloads/).
2. Установите Python, следуя инструкциям для вашей операционной системы. Убедитесь, что установлена галочка "Add Python to PATH".
3. Проверьте установку pip, запустив команду в командной строке:
    ```bash
    python -m ensurepip --upgrade
    ```

### Настройка виртуального окружения

Для изоляции зависимостей проекта рекомендуется использовать виртуальное окружение.

1. Создайте виртуальное окружение:
    ```bash
    python -m venv venv
    ```
2. Активируйте виртуальное окружение:
    - Windows:
        ```bash
        venv\Scripts\activate
        ```
    - macOS/Linux:
        ```bash
        source venv/bin/activate
        ```

### Установка зависимостей

После активации виртуального окружения установите необходимые зависимости:

```bash
pip install -r requirements.txt
```

## Настройка

### Подготовка данных

Перед запуском программы необходимо подготовить данные. Используйте скрипты и инструменты, включенные в проект, для конвертации и подготовки данных. Например, конвертируйте данные из формата JP2 в GeoTIFF и объедините каналы для работы в RGB-представлении.

### Конфигурация

Настройте конфигурационные файлы или переменные окружения, если это необходимо. Обычно конфигурация хранится в файле `.env` или `config.py`.

## Использование

### Запуск программы

Для запуска программы используйте следующую команду:

```bash
python Final_qualifying_work.py
```
![Приветственное меню программы](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_030427.png)


### Обучение модели

Для запуска процесса обучения модели используйте файл `TrainSegformerApp.py`:

```bash
python TrainSegformerApp.py
```
![Меню работы с нейросетью](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_030431.png)

### Взаимодействие с программой

Программа включает несколько ключевых функций:

1. **Обучение модели**: Интерфейс позволяет запускать обучение модели нейронной сети, отслеживать прогресс и просматривать метрики обучения и валидации.
2. **Предсказание**: Интерфейс для взаимодействия с обученной моделью, позволяющий загружать изображения и получать результаты предсказания.
3. **Просмотр метрик**: Визуализация метрик обучения и валидации для анализа эффективности модели.

### Примеры использования

- Обучение модели:
    ```bash
    python TrainSegformerApp.py
    ```

## Нюансы работы

### Обновление зависимостей

При необходимости обновите зависимости:

```bash
pip install --upgrade -r requirements.txt
```

### Логи

Программа ведет логи в директорию `logs`. В случае возникновения ошибок или сбоев, проверьте файлы логов для получения дополнительной информации.

### Остановка программы

Для остановки программы используйте стандартное прерывание (Ctrl+C) или остановите процесс через системный диспетчер задач.

### Часто встречающиеся ошибки

1. **Ошибка при установке зависимостей**: Убедитесь, что все зависимости указаны в `requirements.txt` и у вас есть доступ к интернету для их скачивания.
2. **Ошибка при запуске**: Проверьте конфигурационные файлы и входные данные. Убедитесь, что все переменные окружения установлены корректно.

## Скриншоты работы программы

### Окно предподготовки директории и результат работы

| Окно предподготовки директории | Результат редподготовки директории |
|-------------|-------------|
| ![Окно предподготовки директории](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_033141.png) | ![Результат редподготовки директории](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_033411.png) |

### Окно конвертирования и объединения файлов

| Конвертация .jp2 + .xml -> .tiff и объединение каналов в один файл | Директория с результатами конвертации и объединения каналов |
|-------------|-------------|
| ![Конвертация .jp2 + .xml -> .tiff и объединение каналов в один файл](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_034027.png) | ![Директория с результатами конвертации и объединения каналов](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_034244.png) |

### Окна кадрирования и конфертации изображения

| Кадрирование изображений | Конвертация .tiff -> .png |
|-------------|-------------|
| ![Кадрирование изображений](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_034901.png) | ![Конвертация .tiff -> .png](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_035127.png) |

### Обучение нейронной сети

| Подготовка датасета для обучения | Обучение архитектуры Segformer |
|-------------|-------------|
| ![Подготовка датасета для обучения](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_035834.png) | ![Обучение архитектуры Segformer](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_040257.png) |

### Метрики обучения нейронной сети

| Fold № | График метрик обучения |
|-------------|-------------|
| Fold 1 | ![Обучение архитектуры Segformer](/metrics_fold_1.png) |
| Fold 2 | ![Обучение архитектуры Segformer](/metrics_fold_2.png) |
| Fold 3 | ![Обучение архитектуры Segformer](/metrics_fold_3.png) |
| Fold 4 | ![Обучение архитектуры Segformer](/metrics_fold_4.png) |
| Fold 5 | ![Обучение архитектуры Segformer](/metrics_fold_5.png) |
| Fold 6 | ![Обучение архитектуры Segformer](/metrics_fold_6.png) |
| Fold 7 | ![Обучение архитектуры Segformer](/metrics_fold_7.png) |
| Fold 8 | ![Обучение архитектуры Segformer](/metrics_fold_8.png) |
| Fold 9 | ![Обучение архитектуры Segformer](/metrics_fold_9.png) |
| Fold 10 | ![Обучение архитектуры Segformer](/metrics_fold_10.png) |

### Метрики обучения нейронной сети

| График средних значений метрик обучения | График метрик обучения на одной части (Fold 10) |
|-------------|-------------|
| ![График средних значений метрик обучения](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_040623.png) | ![График метрик обучения на одной части (Fold 10)](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_040640.png) |

### Взаимодействие с нейросетью

| ![Взаимодействие с нейросетью](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_114358.png) | ![Взаимодействие с нейросетью](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_114416.png) | ![Взаимодействие с нейросетью](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_114826.png) |
|-------------|-------------|-------------|

| Результаты работы нейросети |
|-------------|
| ![Взаимодействие с нейросетью](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_050434.png) |

| GeoTIFF + Shape-файл | Маска территории | Изображение исходной территории | Наложение маски на исходное изображение | Наложение маски на исходное изображение |
|-------------|-------------|-------------|-------------|-------------|
|  ![GeoTIFF + Shape-файл](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_052602.png) | ![Маска территории](/prediction_results/7_mask.bmp) | ![Изображение исходной территории](/prediction_results/7_original.png) | ![Наложение маски на исходное изображение](/prediction_results/7_object.png) | ![Наложение маски на исходное изображение](/prediction_results/7_transparent_object.png) |
|  ![GeoTIFF + Shape-файл](/Скриншоты_работы_программы/Снимок_экрана_2024_06_30_052057.png) | ![Маска территории](/prediction_results/17_mask.bmp) | ![Изображение исходной территории](/prediction_results/17_original.png) | ![Наложение маски на исходное изображение](/prediction_results/17_object.png) | ![Наложение маски на исходное изображение](/prediction_results/17_transparent_object.png) |

## Контакты

[Leunenko Artem Olegovich]  
[al.university.edu@yandex.ru]

## Лицензия

Этот проект лицензирован на условиях лицензии MIT. Подробнее см. [LICENSE](LICENSE.txt).
